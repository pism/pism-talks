%%% Local Variables: 
%%% coding: utf-8
%%% mode: latex
%%% TeX-engine: xetex
%%% End: 

\documentclass[hide notes,intlimits]{beamer}

\mode<presentation>
{
  \usetheme{PISMshade}
  \setbeamercovered{transparent}
}

% load packages
\usepackage{media9}
\usepackage[english]{babel}
\usepackage[multidot]{grffile}

\usepackage{tikz}
\usetikzlibrary{shapes,arrows}
\usetikzlibrary{shadows}

\definecolor{dark red}{HTML}{E41A1C}
\definecolor{dark green}{HTML}{4DAF4A}
\definecolor{dark violet}{HTML}{984EA3}
\definecolor{dark blue}{HTML}{084594}
\definecolor{dark orange}{HTML}{FF7F00}
\definecolor{light blue}{HTML}{377EB8}
\definecolor{light red}{HTML}{FB9A99}
\definecolor{light violet}{HTML}{CAB2D6}

\setbeamercolor{boxed}{fg=black,bg=light blue!25}
\graphicspath{{figures/}{../figures/}{../figures_2018_08/}{../2021_09_cph/figures/}}

\newenvironment{transbox}[1][]{%
\begin{tikzpicture}
\node[drop shadow,rounded corners,text width=.9\textwidth,fill=white, fill opacity=#1,text opacity=1] \bgroup
}{
\egroup;\end{tikzpicture}} 

\newenvironment{transbox-tight}{%
\begin{tikzpicture}
\node[drop shadow,rounded corners,fill=uaf yellow, fill opacity=0.75,text opacity=1] \bgroup
}{
\egroup;\end{tikzpicture}} 

\newcommand{\jl}{[\![}
\newcommand{\jr}{]\!\hskip 0.003cm ]}
\newcommand{\bpsi}{\boldsymbol{\psi}}
\newcommand{\bPsi}{\boldsymbol{\Psi}}
\newcommand{\bphi}{\boldsymbol{\phi}}
\newcommand{\bPhi}{\boldsymbol{\Phi}}
\newcommand{\bn}{\mathbf{n}}
\newcommand{\bq}{\mathbf{q}}
\newcommand{\bv}{\mathbf{v}}
\newcommand{\D}{\,\mathrm{d}}
\newcommand{\Tsnow}{T_{\text{snow}}}
\newcommand{\Hatm}{H_{\text l}^{\text{atm}}}

\newcommand{\mathtext}[1]{\mathsf{#1}}

% title page
\title[Ice sheet modeling] % (optional, use only with long paper titles)
{Towards credible projections of sea-level rise}

\author[Aschwanden] % (optional, use only with lots of authors)
{\textbf{Andy Aschwanden}\\ with \\D. Brinkerhoff, M. Truffer, T. Bartholomaus}
\institute{Geophysical Institute, University of Alaska Fairbanks}

% - Give the names in the same order as the appear in the paper.
% - Use the \inst{?} command only if the authors have different
%   affiliation.

% - Use the \inst command only if there are several affiliations.
% - Keep it simple, no one is interested in your street address.

% \titlegraphic{\vskip-1.cm\includegraphics[height=3.5cm]{gris-green-collage-clean}}

\date{}


\subject{The Greenland Ice Sheet}

\begin{document}



\setbeamertemplate{background canvas}
  {
     \tikz{\node[inner sep=0pt,opacity=0.5] {\includegraphics[width=\paperwidth]{earth-drowning}};}
}


 
% insert titlepage
\begin{frame}
  \titlepage
  \note[item]{Collaboration Martin, Doug, Tim}
\end{frame}


\setbeamertemplate{background canvas}
  {
     \tikz{\node[inner sep=0pt,opacity=0.5] {\includegraphics[width=\paperwidth]{earth-drowning-desat}};}
}

\begin{frame}{Modern sea-level change}
  \vspace{-1.5em}
  \begin{minipage}[t][5cm][t]{\textwidth}
    \begin{figure}
      \includegraphics<1->[height=5cm]{sea-level-from-altimetry}\\
    \end{figure}
  \end{minipage}
  \vspace{-2.em}
  \begin{minipage}[t][4cm][t]{\textwidth}
  \begin{columns}[c]
    \begin{column}{.45\textwidth}
      \uncover<1>{Sea-level contribution 1993--18}
      \uncover<2>{Sea-level contribution 2006--18}
    \end{column}
    \begin{column}{.45\textwidth}
    \includegraphics<1>[height=2.75cm]{sea-level-contrib-1993-2018}
    \includegraphics<2>[height=2.75cm]{sea-level-contrib-2006-2018}
    \end{column}
  \end{columns}
  \end{minipage}
\end{frame}

\setbeamertemplate{background canvas}
{
%
}




\begin{frame}{A brief history of model-based projections in IPCC}
  \begin{columns}[c]
    \begin{column}{.1\linewidth}
      Year
    \end{column}
    \begin{column}{.1\linewidth}
      Report
    \end{column}
    \begin{column}{.12\linewidth}
      \# 
    \end{column}
    \begin{column}{.60\linewidth}
      Type of models
    \end{column}
  \end{columns}
  \vspace{0.25em}
  \hrule

  \begin{columns}[c]
    \begin{column}{.1\linewidth}
      2007
    \end{column}
    \begin{column}{.1\linewidth}
      AR4
    \end{column}
    \begin{column}{.12\linewidth}
      0
    \end{column}
    \begin{column}{.6\linewidth}
      \begin{itemize}
      \item models excluded due to their inability to track modern ice sheet change
      \end{itemize}
    \end{column}
  \end{columns}
  \hrule

\end{frame}


\begin{frame}{Observed vs simulated flow speeds (2007 model)}
  \begin{columns}[c]
    \begin{column}{.6\linewidth}
    \begin{figure}
      \includegraphics[height=5.75cm]{gris-obs-exp-old}
      \\ \tiny{adapted from Aschwanden, Fahnestock, Truffer (2016) \textit{Nature Comms.}}
    \end{figure}
    \end{column}
    \begin{column}{.4\linewidth}
      \begin{figure}
        \includegraphics[width=.75\textwidth]{roadblocks}
      \end{figure}
      \begin{itemize}
      \item can't reproduce the velocity field
      \end{itemize}
    \end{column}
  \end{columns}
  \note[item]{}
\end{frame}



\begin{frame}{A brief history of model-based projections in IPCC}
  \begin{columns}[c]
    \begin{column}{.1\linewidth}
      Year
    \end{column}
    \begin{column}{.1\linewidth}
      Report
    \end{column}
    \begin{column}{.12\linewidth}
      \# 
    \end{column}
    \begin{column}{.60\linewidth}
      Type of models
    \end{column}
  \end{columns}
  \vspace{0.25em}
  \hrule

  \begin{columns}[c]
    \begin{column}{.1\linewidth}
      2007
    \end{column}
    \begin{column}{.1\linewidth}
      AR4
    \end{column}
    \begin{column}{.12\linewidth}
      0
    \end{column}
    \begin{column}{.6\linewidth}
      \begin{itemize}
      \item models excluded due to their inability to track modern ice sheet change
      \end{itemize}
    \end{column}
  \end{columns}
  \hrule

  \begin{columns}[c]
    \begin{column}{.1\linewidth}
      2013
    \end{column}
    \begin{column}{.1\linewidth}
      AR5
    \end{column}
    \begin{column}{.12\linewidth}
      unclear
    \end{column}
    \begin{column}{.60\linewidth}
      \begin{itemize}
      \item models split between surface mass balance and dynamical changes
      \item multi-model ensemble was not used directly
      \end{itemize}
    \end{column}
  \end{columns}
  \hrule

\end{frame}

\begin{frame}{Observed vs simulated flow speeds (2013 model)}
  \begin{columns}[c]
    \begin{column}{.6\linewidth}
    \begin{figure}
      \includegraphics[height=5.75cm]{gris-obs-exp-old}
      \\ \tiny{adapted from Aschwanden, Fahnestock, Truffer (2016) \textit{Nature Comms.}}
    \end{figure}
    \end{column}
    \begin{column}{.4\linewidth}
      \begin{figure}
        \includegraphics[width=.75\textwidth]{roadblocks}
      \end{figure}
      \begin{itemize}
      \item still can't reproduce the velocity field
      \end{itemize}
    \end{column}
  \end{columns}
  \note[item]{}
\end{frame}




\begin{frame}{Post 2014 models}
  \alert{Have the models gotten any better?}
  \begin{columns}[c]
    \begin{column}{.6\linewidth}
    \begin{figure}
      \includegraphics[height=5.75cm]{gris-obs-exp-new}
      \\ \tiny{adapted from Aschwanden, Fahnestock, Truffer (2016) \textit{Nature Comms.}}
    \end{figure}
    \end{column}
    \begin{column}{.4\linewidth}
      \begin{figure}
        % \includegraphics[height=1cm]{oib} \\
        \includegraphics[height=5.75cm]{greenland-bed-mcb}
      \\ \tiny{adapted from Morlighem et al. (2014) \textit{Nature Geosci}}
      \end{figure}
    \end{column}
  \end{columns}
  \alert{Accurate ice thickness does the trick}
  
  \note[item]{first time capturing the flow field for the right reason}
  \note[item]{this is quite a break through in ice sheet modeling}
  \note[item]{though not a surprising one}
  \note[item]{it just confirms what students learn in glaciology 100:}
  \note[item]{ice flows downhill}
\end{frame}

\begin{frame}{A brief history of model-based projections in IPCC}
  \begin{columns}[c]
    \begin{column}{.1\linewidth}
      Year
    \end{column}
    \begin{column}{.1\linewidth}
      Report
    \end{column}
    \begin{column}{.12\linewidth}
      \# 
    \end{column}
    \begin{column}{.60\linewidth}
      Type of models
    \end{column}
  \end{columns}
  \vspace{0.25em}
  \hrule

  \begin{columns}[c]
    \begin{column}{.1\linewidth}
      2007
    \end{column}
    \begin{column}{.1\linewidth}
      AR4
    \end{column}
    \begin{column}{.12\linewidth}
      0
    \end{column}
    \begin{column}{.6\linewidth}
      \begin{itemize}
      \item models excluded due to their inability to track modern ice sheet change
      \end{itemize}
    \end{column}
  \end{columns}
  \hrule

  \begin{columns}[c]
    \begin{column}{.1\linewidth}
      2013
    \end{column}
    \begin{column}{.1\linewidth}
      AR5
    \end{column}
    \begin{column}{.12\linewidth}
      unclear
    \end{column}
    \begin{column}{.60\linewidth}
      \begin{itemize}
      \item models split between surface mass balance and dynamical changes
      \item multi-model ensemble was not used directly
      \end{itemize}
    \end{column}
  \end{columns}
  \hrule

  \begin{columns}[c]
    \begin{column}{.1\linewidth}
      2021
    \end{column}
    \begin{column}{.1\linewidth}
      AR6
    \end{column}
    \begin{column}{.12\linewidth}
      14 (GIS)\\ 18 (AIS)
    \end{column}
    \begin{column}{.60\linewidth}
      \begin{itemize}
      \item multi-model ensemble
      \item Ice Sheet Model Intercomparison for CMIP Phase 6 (ISMIP6)
        \includegraphics<1>[width=2cm]{ismip6_logo}
      \end{itemize}
    \end{column}
  \end{columns}
  \hrule
  \vspace{0.5em}
  AIS: Antarctic Ice Sheet, \quad GIS: Greenland Ice Sheet  
\end{frame}


\begin{frame}{Modern and projected mass loss from Greenland}
  \begin{figure}
    \includegraphics<1>[width=3cm]{ismip6_logo}
  \end{figure}
  \begin{figure}
    \includegraphics<1>[width=\textwidth]{ar6-fig17-no-zoom}
  \end{figure}
\end{frame}

\begin{frame}{All sunshine? Wait a minute\ldots}
  \begin{figure}
    \includegraphics[width=\textwidth]{GIS_hist_with_obs}
    \caption{Aschwanden, Brinkerhoff, Bartholomaus, \& Truffer (in press)}
  \end{figure}
  \begin{columns}[c]
    \begin{column}{.5\textwidth}
      \begin{minipage}[t][.5\textheight][t]{\textwidth}
        \alert{Almost all historical simulations under-estimate modern mass loss}
      \end{minipage}
    \end{column}
    \begin{column}{.25\textwidth}
      \begin{minipage}[t][.5\textheight][t]{\textwidth}
        \begin{figure}
          \includegraphics<2>[width=1.8cm]{brain_thinking}
        \end{figure}
      \end{minipage}
    \end{column}
  \end{columns}
\end{frame}


\begin{frame}{Modern and projected Arctic sea ice extend}
  \begin{minipage}[t][1.25cm][t]{\textwidth}
    \begin{figure}
      \includegraphics<1->[width=1cm]{brain_solution}
    \end{figure}
  \end{minipage}
  \vspace{0.25em}
  \begin{minipage}[t][6.25cm][b]{\textwidth}
    \begin{figure}
          \includegraphics<2>[height=6cm]{grl23061-fig-0001}
    \end{figure}
  \end{minipage}
\end{frame}



\begin{frame}{AS19 Projections}
  \begin{figure}
    \includegraphics[width=0.9\textwidth]{projection_as19_bars}
  \end{figure}
\begin{itemize}
\item 500 member ensemble to assess parametric uncertainty
\item all scenarios show large variance, which is a feature not a bug
\end{itemize}
\note[item]{}
\end{frame}


\begin{frame}{Limitations of AS19 and ISMIP6}
  \begin{figure}
    % \includegraphics[width=0.75\textwidth]{IS_historical}
  \end{figure}
\begin{itemize}
\item AS19 did prior calibration and literature values to define probability distributions of parameters \alert{but}
\item did \alert{NOT} excplicitly condition on observations
\item see our commentary in TCD (in revision)
\end{itemize}
\note[item]{}
\end{frame}

\begin{frame}{2-step calibration}
Which quantities should we use?
\begin{itemize}
\item use the quantity of interest: mass change
\item use quantity that contributes a lot to uncertainty: ice flow
\end{itemize}
\note[item]{}
\end{frame}

\begin{frame}{1. Ice Flow: calibrate parameters}
\begin{itemize}
\item use Markov Chain Monte Carlo sampling to find the joint distribution of these parameters.
\item think of PISM as a map $\mathcal{F}$ from a parameter vector $\mathbf{x}$ to surface speeds $\mathbf{Y}$
\begin{equation}
\mathbf{Y} = \mathcal{F}(\mathbf{x})
\end{equation}
\item running the forward model (PISM) is too expensive for MCMC
\item Generate a ``cheap'' surrogate model $\mathcal{G}$ such that
\begin{equation}
\mathcal{G}(\mathbf{x}) \approx \mathcal{F}(\mathbf{x})
\end{equation}
\end{itemize}

  \note[item]{We take a Bayesian approach and use Markov Chain Monte Carlo sampling to find the joint distribution of these parameters.  While this problem is computationally challenging due to the significant expense of running the forward model, we made it tractable by employing a neural-network based surrogate model that provides a low-cost mapping from parameters to velocity fields \citep{Brinkerhoff2020}.}
\end{frame}

\begin{frame}{1. Ice Flow: training data}
\begin{itemize}
\item select 8 relevant parameters
\item define a prior probability distribution for each parameter
\item draw 1,000 samples using Sobol Sequences
\item run PISM 1,000 times
\end{itemize}
\end{frame}

\begin{frame}{1. Ice Flow: Surrogate model}
\begin{itemize}
\item use 4 layer Neural Network surrogate model by Brinkerhoff et al (2021)
\item implemented in PyTorch
\item train surrogate model on NVIDIA GPU
\end{itemize}
\end{frame}

\begin{frame}{1. Ice Flow: Surrogate model}
  \begin{figure}
    \includegraphics<1->[width=\textwidth]{prior_posterior}
  \end{figure}
\end{frame}



%% \begin{frame}{Challenge $\mathbf{Y}$ is not a scalar}
%% Compared to e.g., Hill (2021), Edwards (2019, 2021), etc, our $\mathbf{Y}$ is \alert{not} a scalar:
%% \begin{eqnarray}
%% \mathbf{x} = \{x_1, x_2,\ldots,x_n\}, & n = 8, \\ 
%% \mathbf{Y} = \{Y_1, Y_2, \ldots,Y_m \},& m \ge 10^6
%% \end{eqnarray}
%%   \note[item]{}
%% \end{frame}

%% \begin{frame}{Solution: dimensionality reduction using PCA}
%% \begin{itemize}
%% \item decompose training data into ``eigen-glaciers'' using Pricipal Component Analysis (``eigen faces'' in picture analysis)
%% \item we only need to simulate the first $\sim$50 eigen-coefficients to capture 99.95\% of the variance
%% \item we have reduce the problem from 10$^6$ to $\sim$50 unknowns.
%% \end{itemize}
%% \end{frame}


\begin{frame}{Calibrated Projections}
  \begin{figure}
    \includegraphics<1>[width=0.75\textwidth]{projection_as19_bars}
    \includegraphics<2>[width=0.75\textwidth]{projection_calibrated_bars}
  \end{figure}
\end{frame}

\end{document}
